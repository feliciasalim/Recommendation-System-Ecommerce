# -*- coding: utf-8 -*-
"""Sistem_Rekomendasi_Felicia_Salim.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1T1bbQm5rrcH5_ewcsQMwTTPldKCR8bs0

# **1. Import Library**

Library yang akan digunakan pada notebook ini adalah:

- pandas: untuk memproses dan menganalisis data dalam bentuk tabel (dataframe).
- numpy: untuk operasi numerik.
- seaborn dan matplotlib.pyplot: untuk visualisasi data.
- sklearn.feature_extraction.text.TfidfVectorizer: untuk mengubah data teks menjadi representasi numerik menggunakan metode TF-IDF.
- sklearn.metrics.pairwise.cosine_similarity: untuk menghitung kemiripan antar item berdasarkan vektor TF-IDF.
- tensorflow dan keras: untuk membangun model ML.
"""

import pandas as pd
import numpy as np
import seaborn as sns
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import matplotlib.pyplot as plt

"""# **2. Data Loading**

Dataset yang digunakan dalam proyek ini diambil dari [Kaggle E-Commerce Dataset](https://www.kaggle.com/datasets/shivrajguvi/e-commerce-dataset-for-practice) dan merupakan simulasi transaksi pengguna yang mencakup informasi pengguna, produk, transaksi, dan perilaku pengguna. Dataset ini terdiri dari beberapa fitur yaiu:
- UserID: Identifikasi unik untuk setiap pengguna.
- UserName: Nama pengguna yang disimulasikan.
- Age: Usia pengguna (antara 18 hingga 70 tahun).
- Gender: Jenis kelamin pengguna (Male, Female, atau Non-Binary).
- Country: Negara asal pengguna (USA, Canada, UK, Australia, India, Germany).
- SignUpDate: Tanggal pengguna mendaftar di platform.
- ProductID: Identifikasi unik untuk setiap produk.
- ProductName: Nama produk yang dibeli (misalnya: Laptop, Smartphone, Headphones, dsb.).
- Category: Kategori produk (Electronics, Apparel, Books, Accessories).
- Price: Harga produk ($)
- PurchaseDate: Tanggal transaksi dilakukan.
- Quantity: Jumlah unit produk yang dibeli dalam satu transaksi.
- TotalAmount: Total nominal yang dibelanjakan oleh pengguna (Price * Quantity).
- HasDiscountApplied: Menunjukkan apakah diskon diterapkan dalam transaksi (True/False).
- DiscountRate: Besarnya diskon yang diberikan (antara 0 hingga 0.5).
- ReviewScore: Skor ulasan yang diberikan pengguna untuk produk (1 hingga 5).
- ReviewText: Ulasan dalam bentuk teks singkat (Excellent, Good, Average, Poor).
"""

#Load dataset
pd.set_option('display.max_columns', None)
df = pd.read_csv('ecommerce_synthetic_dataset.csv')
df.head()

"""# **3. Exploratory Data Analysis**

Tujuan dari EDA adalah untuk memperoleh wawasan awal yang mendalam mengenai data dan menentukan langkah selanjutnya dalam analisis atau pemodelan. Beberapa tahapan EDA yang akan dilakukan adalah pemahaman terhadap struktur data, analisis setiap fitur, pengecekan data duplikat dan nilai null, analisis univariate serta analisis outlier data.
"""

df.info()

"""**Inisght:** Terdapat 21 fitur pada dataset ecommerce yang digunakan. Fitur tersebut terdiri dari 12 fitur dengan tipe string, 4 fitur dengan tipe integer, dan 5 fitur dengan tipe float. Dataset terdiri dari 100.000 row."""

#Eksplor Parameter Statistik
df.describe(include="all")

"""**Insight:**

- Terdapat 3 jenis kelamin pada dataset yang kemungkinan karena mengikuti gaya hidup barat (non-binary).
- Mayoritas pelanggan dari ecommerce berasal dari USA dengan 16844 pelanggan.
- Barang yang paling sering dibeli adalah T-Shirt dan kategori yang paling menjual adalah Apparel.
- Orang-orang sering melakukan pembelian barang dari ecommerce melalui mobile atau ponsel.
- Referal aplikasi ecommerce kebanyakan didapatkan dari marketing email yang ditujukan pada pelanggan, sehingga menandakan bahwa teknik marketing ini cukup bagus.
- Pada kolom ReviewScore, terdapat data yang abnormal yaitu reviewnya bernilai negatif. Range dari nilai review juga salah karena range harusnya dari 1-5, sehingga nilai rating yang lebih dari 5 itu salah. Maka, ini harus ditangani pada tahap preprocessing nanti.
"""

#Cek data null
df.isna().sum()

"""**Insight:** Tidak ada nilai null"""

#Cek data duplikat
df.duplicated().sum()

"""**Insight:** Tidak ada nilai duplikat."""

#Info tentang negara asal dari pembeli
df['Country'].value_counts()

"""**Insight:** Pengguna berasal dari enam negara utama yaitu: USA, Canada, UK, Germany, Australia, dan India. Jumlah pengguna juga seimbang dengan sekitar +/- 16.500 pengguna per negara. Hal ini menandakan bahwa produk memiliki jangkauan global yang merata. Mayoritas pengguna berasal dari USA sebanyak 16844 pengguna."""

#Info tentang tipe product yang ada
df['ProductName'].value_counts()

#Visualisasi tipe produk
plt.figure(figsize=(8, 5))

sns.countplot(x=df['ProductName'])
plt.title('Product Name')

"""**Insight:** Produk yang paling banyak dibeli adalah T-shirt dengan 14.401 pembelian dan diikuti sangat dekat oleh Headphones, Book, Watch, Shoes, Laptop, dan Smartphone. Namun, produk yang dibeli cukup seimbang untuk semua tipe produk. Ini menandakan bahwa pelanggan menunjukkan minat yang seimbang terhadap berbagai jenis barang."""

#Info tentang tipe kategori yang ada
df['Category'].value_counts()

#Visualisasi tipe Category
plt.figure(figsize=(8, 5))

sns.countplot(x=df['Category'])
plt.title('Category')

"""**Insight:** Kategori produk yang paling banyak diminati adalah Apparel yang kemudian diikuti dengan Accessories, Electronics, dan Books. Semua kategori juga seimbang yang menunjukkan bahwa konsumen memiliki preferensi yang cukup merata terhadap berbagai kategori."""

#Info tentang tipe referal yang ada
df['ReferralSource'].value_counts()

#Visualisasi tipe referal
plt.figure(figsize=(8, 5))

sns.countplot(x=df['ReferralSource'])
plt.title('Referral Source')

"""**Insight:** Dapat dilihat bahwa ada 4 metode referal yang digunakan oleh platform ecommerce dari dataset ini, dengan metode paling tinggi Email Marketing, diikuti oleh Ad Campaign, Organic Search dan Sosial Media."""

#Info tentang tipe review yang ada
df['ReviewText'].value_counts()

#Visualisasi tipe review
plt.figure(figsize=(8, 5))

sns.countplot(x=df['ReviewText'])
plt.title('Review Text')

"""**Insight:** Terdapat 4 tipe review yang ada pada dataset ecommerce yaitu Excellent, Good, Poor, dan Average. Mayoritas review bernilai Excellent yang berarti banyak yang puas dengan transaksi pembelian mereka."""

# Melihat kaitan ReviewText dan ReviewScore (Apakah ReviewText buruk berarti ReviewScore Rendah? Dan sebaliknya?)
# Jika iya, maka harusnya tidak ada hasil untuk kode di bawah
df[(df['ReviewText'] == 'Poor') & (df['ReviewScore'] > 7)].head(5)

"""**Insight:** Setelah tabel di atas dianalisis, dapat disimpulkan bahwa ReviewScore dan ReviewText tidak memiliki kaitan yang berbanding lurus. Sehingga, kita kemungkinan hanya akan menggunakan ReviewScore untuk pembangunan model nantinya."""

#Melihat ReviewScore yang tidak berada di range 1-5
df[(df['ReviewScore'] > 5) | (df['ReviewScore'] < 1)]

"""**Insight:** Terdapat 14898 data yang tidak berada dalam range 1-5 dan kita harus drop data tersebut dikarenakan tidak bisa diperbaiki menggunakan IQR atau metode lain. Sangat disayangkan namun tidak masalah karena jumlah data masih banyak jika terdapat 15.000 data yang di drop."""

#Melihat apakah ProductName sesuai dengan Category (Cth: T-shirt = Apparel, Smartphone = Electronics)
df[(df['ProductName'] == 'Smartphone') & (df['Category'] != 'Electronics')].head(5)

"""**Insight:** Terdapat data yang abnormal dimana Smartphone menjadi kategori Apparel, padahal seharusnya masuk ke kategori Electronics. Hal yang sama terjadi pada banyak data. Oleh karena itu kita akan mengubah kolom Category sesuai dengan nama produk."""

#Visualisasi Boxplot ReviewScore & Score
plt.figure(figsize=(15, 5))

plt.subplot(1, 3, 2)
sns.boxplot(x=df['ReviewScore'])
plt.title('Review Score')

plt.subplot(1, 3, 3)
sns.boxplot(x=df['Age'])
plt.title('Age')

"""**Insight:** Terdapat banyak outlier pada fitur ReviewScore, yang menandakan data abnormal seperti adanya banyak review negatif pada data. Untuk fitur age, tidak ada outlier dan semuanya normal.

# **4. Data Preprocessing**

### Drop data abnormal

Kita akan drop ReviewScore yang lebih dari 5 dan kurang dari 1. Ini dilakukan karena dari website dataset dinyatakan bahwa range ReviewScore hanya 1-5, jadi nilai diluar dari range tersebut adalah data abnormal/outlier.
"""

#Drop review > 5 dan < 1
final_df = df[(df['ReviewScore'] <= 5) & (df['ReviewScore'] >= 1)]
final_df

"""### Drop fitur yang tidak diperlukan

Drop kolom UserName, SignUpDate, PurchaseDate, Quantity, TotalAmount, HasDiscountApplied, DiscountRate, ReviewText, LastLogin, SessionDuration, DeviceType, & ReferralSource karena tidak terlalu diperlukan.
"""

#Drop kolom UserName, SignUpDate, PurchaseDate, Quantity, TotalAmount, HasDiscountApplied, DiscountRate, ReviewText, LastLogin, SessionDuration, DeviceType, & ReferralSource
final_df = final_df.drop(['UserName', 'SignUpDate', 'PurchaseDate', 'Quantity', 'TotalAmount', 'HasDiscountApplied', 'DiscountRate', 'ReviewText', 'LastLogin', 'SessionDuration', 'DeviceType', 'ReferralSource'], axis=1)
final_df

"""### Memperbaiki data abnormal

Kita akan mengubah kolom Category sesuai dengan ProductName. Ini dilakukan karena adanya data abnormal seperti nama produk T-shirt yang berada pada kategori lain selain Apparel.
"""

#Ganti kategori sesuai nama produk
apparel = ['T-shirt', 'Shoes']
electronics = ['Laptop', 'Smartphone']
books = ['Book']
accessories = ['Headphones', 'Watch']
final_df.loc[final_df['ProductName'].isin(apparel), 'Category'] = 'Apparel'
final_df.loc[final_df['ProductName'].isin(electronics), 'Category'] = 'Electronics'
final_df.loc[final_df['ProductName'].isin(books), 'Category'] = 'Books'
final_df.loc[final_df['ProductName'].isin(accessories), 'Category'] = 'Accessories'
final_df

"""### Round nilai ReviewScore

Kita akan round ReviewScore agar lebih mudah untuk diproses ke tahap modeling nantinya.
"""

#Fungsi untuk round (ceil & floor) ReviewScore
def round(x):
    if x % 1 == 0.5:
        return np.ceil(x)
    else:
        return np.floor(x)

#Round ReviewScore
final_df['RoundedScore'] = final_df['ReviewScore'].apply(round)
final_df.drop('ReviewScore', axis=1, inplace=True)
final_df.rename(columns={'RoundedScore': 'ReviewScore'}, inplace=True)
final_df

"""### Membuat ProductName Menjadi Unik"""

#Kombinasi ProductName dengan ProductID supaya produk menjadi unik dan banyak variasi produk
final_df['ProductName'] = final_df['ProductName'] + '_' + final_df['ProductID'].astype(str)

"""### Memastikan dataframe terakhir"""

#Cek dataframe akhir
final_df.info()

#Cek data null
final_df.isna().sum()

#Cek tipe kategori
final_df.Category.unique()

#Cek kategori nama produk
final_df.ProductName.unique()

#Cek kategori id produk
final_df.ProductID.unique()

"""Dari kategori nama produk dan ID produk, dapat dilihat bahwa terdapat lebih banyak ID unik dibandingkan nama produk. Ini tidak apa-apa karena ada kemungkinan bahwa produknya sama tipe tapi beda merek (dari perbedaan ID)."""

#Cek range reviewscore
final_df.ReviewScore.unique()

"""### Content Based Filtering Dataset

Untuk Content Based Filtering kita hanya akan menggunakan kolom ProductID, ProductName, Category, dan Price.
"""

content_based = final_df[['ProductID', 'ProductName', 'Category', 'Price']]
content_based.head()

#Cek duplikat untuk ProductID
content_based[content_based.duplicated(subset=['ProductID'])]

#Drop duplikat tersebut
content_based = content_based.drop_duplicates(subset=['ProductID'])
content_based

"""### Collaborative Filtering Dataset

Untuk dataset collaborative filtering, kita akan memakai UserID, ProductID, ProductName, Category, dan ReviewScore.
"""

collab_df = final_df[['UserID', 'ProductID', 'ProductName', 'Category', 'ReviewScore']].copy()
collab_df

#Mengubah userID menjadi list tanpa nilai yang sama
user_ids = collab_df['UserID'].unique().tolist()
print('list UserID: ', user_ids)

# Melakukan encoding userID
user_to_user_encoded = {x: i for i, x in enumerate(user_ids)}
print('encoded userID : ', user_to_user_encoded)

# Melakukan proses encoding angka ke ke userID
user_encoded_to_user = {i: x for i, x in enumerate(user_ids)}
print('encoded angka ke userID: ', user_encoded_to_user)

#Mengubah ProductID menjadi list tanpa nilai yang sama
product_ids = collab_df['ProductID'].unique().tolist()
print('list ProductID: ', product_ids)

#Melakukan proses encoding ProductID
product_to_product_encoded = {x: i for i, x in enumerate(product_ids)}
print('encoded ProductID : ', product_to_product_encoded)

# Melakukan proses encoding angka ke ke ProductID
product_encoded_to_product = {i: x for i, x in enumerate(product_ids)}
print('encoded angka ke productID: ', product_encoded_to_product)

# Mapping ProductID ke dataframe user
collab_df['user'] = collab_df['UserID'].map(user_to_user_encoded)

# Mapping placeID ke dataframe product
collab_df['product'] = collab_df['ProductID'].map(product_to_product_encoded)

#Cek data yang sudah diencoding
num_users = len(user_to_user_encoded)
print(num_users)

num_product = len(product_encoded_to_product)
print(num_product)

collab_df['ReviewScore'] = collab_df['ReviewScore'].values.astype(np.float32)
min_ReviewScore = min(collab_df['ReviewScore'])
max_ReviewScore = max(collab_df['ReviewScore'])

print('Number of User: {}, Number of Product: {}, Min ReviewScore: {}, Max ReviewScore: {}'.format(
    num_users, num_product, min_ReviewScore, max_ReviewScore
))

#Shuffle data
collab_df = collab_df.sample(frac=1, random_state=42)
collab_df

#Membagi data ke train dan test set
x = collab_df[['user', 'product']].values
y = collab_df['ReviewScore'].apply(lambda x: (x - min_ReviewScore) / (max_ReviewScore - min_ReviewScore)).values

train_indices = int(0.8 * collab_df.shape[0])
x_train, x_val, y_train, y_val = (
    x[:train_indices],
    x[train_indices:],
    y[:train_indices],
    y[train_indices:]
)

print(x, y)

"""# **5. Modeling**

##  A. Content Based Filtering

Content-Based Filtering adalah metode sistem rekomendasi yang merekomendasikan item/produk kepada pengguna berdasarkan kemiripan karakteristik item dengan item/produk yang disukai/dibeli pengguna sebelumnya. Sistem ini menganalisis fitur konten dari item (misalnya genre film atau kategori produk) dan mencocokkannya dengan preferensi pengguna. Content-based filtering digunakan karena dapat memberikan rekomendasi yang dipersonalisasi, sehingga bisa memberikan apa yang pengguna mau.

Kelebihan:
- Tidak memerlukan data dari pengguna lain (bisa bekerja untuk satu user saja).
- Memberikan rekomendasi yang lebih personal sehingga meningkatkan kepuasan pengguna.
- Tidak terpengaruh oleh popularitas item sehingga fokus ke data mirip saja.

Kekurangan:
- Susah untuk merekomendasikan item yang sangat berbeda dari history pengguna.
- Bergantung pada kualitas fitur item yang artinya memerlukan data konten yang lengkap dan relevan.

### Inisialisasi TF-IDF

TF-IDF adalah teknik yang mengukur seberapa penting sebuah kata dalam sebuah dokumen. Pada proses ini, TF-IDF akan digunakan untuk mengubah data teks (seperti kategori, nama produk, dll.) menjadi representasi numerik, sehingga kita bisa hitung kemiripannya antar item menggunakan metode cosine similarity.
"""

#Inisialisasi TF-IDF
tfidf = TfidfVectorizer()
tfidf.fit(content_based['Category'])
tfidf.get_feature_names_out()

# Melakukan fit lalu ditransformasikan ke bentuk matrix
tfidf_matrix = tfidf.fit_transform(content_based['Category'])
tfidf_matrix.shape

# Mengubah vektor tf-idf dalam bentuk matriks dengan fungsi todense()
tfidf_matrix.todense()

"""### Menghitung Cosine Similarity

Cosine Similarity adalah metode untuk mengukur kemiripan antara dua vektor berdasarkan sudut cosine di antara mereka. Jadi kita akan menghitung cosine similarity dari matriks TF-IDF yang didapat sebelumnya. Semakin tinggi nilainya, semakin mirip item tersebut, jadi besar kemungkinan mereka direkomendasikan bersama. Rumus:

![image.png](data:image/png;base64,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)

dimana:
- A⋅B: dot product antara dua vektor
- ∥A∥: panjang dari vektor A
- ∥B∥: panjang dari vektor B
"""

# Menghitung similarity dengan cosine similarity
cosine_sim = cosine_similarity(tfidf_matrix)
cosine_sim

# Membuat dataframe dari variabel similarity
similarity_df = pd.DataFrame(cosine_sim, index=content_based['ProductName'], columns=content_based['ProductName'])
print('Shape:', similarity_df.shape)

similarity_df.sample(5, axis=1).sample(10, axis=0)

"""### Hasil Rekomendasi"""

#Fungsi untuk mendapatkan rekomendasi
def recommendations(ProductName, similarity_data=similarity_df, items=content_based[['ProductName', 'Category']], k=5):
    index = similarity_data.loc[:,ProductName].to_numpy().argpartition(range(-1, -k, -1))
    closest = similarity_data.columns[index[-1:-(k+2):-1]]
    closest = closest.drop(ProductName, errors='ignore')
    return pd.DataFrame(closest).merge(items).head(k)

content_based[content_based.ProductName.eq('Shoes_8395')]

#Top 5 rekomendasi untuk yang membeli sepatu 8395
rec = recommendations('Shoes_8395')
rec

"""Jadi top 5 rekomendasi untuk orang yang membeli Shoes_8395 adalah T-shirt_5509, T-shirt_6373, Shoes_2168, T-shirt_3229, dan Shoes_5176.

## B. Collborative Filtering

Collaborative Filtering adalah metode sistem rekomendasi yang memberikan saran produk atau item kepada pengguna berdasarkan interaksi dan preferensi pengguna lain yang serupa. Jadi bukan menggunakan informasi konten dari item (seperti kategori atau deskripsi), melainkan memakai pola perilaku pengguna, seperti rating, pembelian, atau klik. Dengan kata lain, sistem ini menyimpulkan bahwa jika pengguna A dan pengguna B menyukai item yang sama, maka item lain yang disukai B kemungkinan juga akan disukai A.

Kelebihan:
- Tidak memerlukan informasi detail tentang item
- Cocok untuk berbagai jenis data
- Dapat menemukan hubungan tidak terduga dari antar item/produk

Kekurangan:
- Cold Start Problem yaitu sulit merekomendasikan untuk pengguna yang belum punya cukup interaksi atau rating.
- Jika dataset sangat besar dan punya banyak nilai kosong, model bisa kesulitan menemukan pola yang kuat.
- Popularitas bisa mendominasi hasil rekomendasi.

### Buat kelas RecommenderNet untuk pembangunan model.
"""

class RecommenderNet(tf.keras.Model):
  # Insialisasi fungsi
  def __init__(self, num_users, num_product, embedding_size, **kwargs):
    super(RecommenderNet, self).__init__(**kwargs)
    self.num_users = num_users
    self.num_product = num_product
    self.embedding_size = embedding_size
    self.user_embedding = layers.Embedding(
        num_users,
        embedding_size,
        embeddings_initializer = 'he_normal',
        embeddings_regularizer = keras.regularizers.l2(1e-6)
    )
    self.user_bias = layers.Embedding(num_users, 1)
    self.product_embedding = layers.Embedding(
        num_product,
        embedding_size,
        embeddings_initializer = 'he_normal',
        embeddings_regularizer = keras.regularizers.l2(1e-6)
    )
    self.product_bias = layers.Embedding(num_product, 1)

  def call(self, inputs):
    user_vector = self.user_embedding(inputs[:,0])
    user_bias = self.user_bias(inputs[:, 0])
    product_vector = self.product_embedding(inputs[:, 1])
    product_bias = self.product_bias(inputs[:, 1])

    dot_user_product = tf.tensordot(user_vector, product_vector, 2)
    x = dot_user_product + user_bias + product_bias
    return tf.nn.sigmoid(x)

#Inisialisasi model & compile
model = RecommenderNet(num_users, num_product, 50)
model.compile(
    loss = tf.keras.losses.BinaryCrossentropy(),
    optimizer = keras.optimizers.Adam(learning_rate=0.001),
    metrics=[tf.keras.metrics.RootMeanSquaredError()]
)

"""### Train model"""

#Training model
history = model.fit(
    x=x_train,
    y=y_train,
    batch_size=512,
    epochs=50,
    validation_data=(x_val, y_val)
)

"""Hasil akhir menunjukkan RMSE 0.14 dan RMSE dari data validasi 0.238

### Menyiapkan dataframe produk yang belum dibeli oleh pengguna.
"""

#Menyiapkan data produk yang belum pernah dibeli oleh satu pengguna acak.
product_df = final_df.drop_duplicates(subset='ProductID') #Ambil produk unik saja karena pada final_df ada kemungkinan pengguna beli produk 2x dan tercatat idnya 2x
df = final_df[['UserID', 'ProductID', 'ProductName', 'Category', 'ReviewScore']].drop_duplicates()

user_id = df.UserID.sample(1).iloc[0]
product_bought_by_user = df[df.UserID == user_id]

product_not_bought = product_df[~product_df['ProductID'].isin(product_bought_by_user.ProductID.values)]['ProductID']
product_not_bought = list(
    set(product_not_bought)
    .intersection(set(product_to_product_encoded.keys()))
)

product_not_bought = [[product_to_product_encoded.get(x)] for x in product_not_bought]
user_encoder = user_to_user_encoded.get(user_id)
user_product_array = np.hstack(
    ([[user_encoder]] * len(product_not_bought), product_not_bought)
)

"""### Menampilkan hasil rekomendasi"""

# Hasil rekomendasi
ratings = model.predict(user_product_array).flatten()
top_ratings_indices = ratings.argsort()[-10:][::-1]
recommended_product_ids = [
    product_encoded_to_product.get(product_not_bought[x][0]) for x in top_ratings_indices
]
print('Showing recommendations for user:', user_id)
print('===' * 9)

recommended_product = product_df[product_df['ProductID'].isin(recommended_product_ids)]
print('Top 10 product recommendations')
print('----' * 8)
for row in recommended_product.itertuples():
    print(row.ProductName, ':', row.Category)

"""Top 10 rekomendasi yang diberikan pada user 74035 adalah Shoes_1584, Smartphone_2408, Shoes_2841, Smartphone_8182, Headphones_5405, Shoes_9131, T-shirt_1447, Laptop_9798, T-shirt_7063, dan Headphones_4657.

# **6. Evaluation**

### Content Based Filtering

Disini untuk modeling content based filtering, metrik evaluasi yang digunakan adalah **precision at k**. Precision adalah metrik evaluasi yang mengukur seberapa banyak rekomendasi terbaik (top-k rekomendasi) yang relevan terhadap kebutuhan pengguna. Di aplikasi ecommerce, pengguna biasanya hanya melihat beberapa rekomendasi teratas. Jadi, kita perlu tahu apakah rekomendasi yang paling atas benar-benar berguna dan sesuai dengan selera mereka dan precision at k ini dapat melihat apakah sistem mampu mengurutkan rekomendasi dengan benar dengan menempatkan item yang relevan di posisi atas.

Cara kerja:
- Ambil top-k rekomendasi dari model (misal k=5).
- Identifikasi rekomendasi dari produk yang diinput.
- Hitung item/produk relevan yang muncul di top-k rekomendasi.
- Hitung precision dengan membagi jumlah item relevan dengan k.

Rumus:

![image.png](data:image/png;base64,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)

dimana:
- Item relevan adalah produk/item yang memang disukai pengguna.
- Top-k rekomendasi adalah k produk yang direkomendasikan pertama kali oleh sistem.
"""

#Fungsi menghitung precision
def count_precision(product_name, recommendations, product_data, k=5):
    original_category = product_data.loc[product_data['ProductName'] == product_name, 'Category'].values[0]
    top_k_recommendations = recommendations.head(k) if isinstance(recommendations, pd.DataFrame) else recommendations[:k]

    if isinstance(top_k_recommendations, pd.DataFrame):
        same_category_count = (top_k_recommendations['Category'] == original_category).sum()
    else:
        same_category_count = sum(
            product_data.loc[product_data['ProductName'] == rec, 'Category'].values[0] == original_category
            for rec in top_k_recommendations
        )

    precision = same_category_count / k
    return precision

precision = count_precision('Shoes_8395', rec, content_based)
print(f'Precision: {precision:.2f}')

"""Precision yang dihasilkan 1.00, berarti semua rekomendasi dalam top-k yang dihasilkan adalah hasil yang relevan untuk pengguna tersebut.

### Collaborative Filtering

Untuk collaborative filtering, kita akan menggunakan metrik evaluasi **Root Mean Squuared Error** (RMSE). RMSE adalah metrik evaluasi yang digunakan untuk mengukur perbedaan antara nilai yang diprediksi oleh model dengan nilai asli. Dalam konteks sistem rekomendasi berbasis collaborative filtering yang memprediksi hasil, RMSE menunjukkan seberapa dekat prediksi model dengan hasil sebenarnya yang diberikan oleh pengguna. Dengan RMSE, kita dapat melihat tren error selama training dan mendeteksi overfitting atau underfitting.
Rumus:

![image.png](data:image/png;base64,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)

Dimana:
- N = jumlah total data (jumlah prediksi yang dibandingkan)
- ri= nilai asli
- ri^ = nilai yang diprediksi oleh model

Disini akan kita visualisasi RMSE dari model yang dibangun sebelumnya untuk melihat apakah model mengalami overfitting atau underfitting.
"""

plt.plot(history.history['root_mean_squared_error'])
plt.plot(history.history['val_root_mean_squared_error'])
plt.title('model_metrics')
plt.ylabel('root_mean_squared_error')
plt.xlabel('epoch')
plt.legend(['train', 'test'], loc='upper left')
plt.show()

"""**Insight:**
- Training Loss sangat fluktuatif di awal sehingga menunjukkan tanda-tanda overfitting. Namun, bisa dilihat training loss turun signifikan yang menandakan model semakin hafal data training.
- Testing loss seimbang pada hampir semua epoch. Ini menunjukkan tidak ada perbaikan performa pada data testing yang mengakibatkan model tidak mampu generalisasi dengan baik.

# **7. Conclusion**

- RMSE pada data train mencapai 0.14 dan RMSE dari data validasi mencapai 0.238.
- Model content based filtering memberikan 5 hasil rekomendasi produk kepada pengguna berdasarkan produk yang dibeli sebelumnya dan mencapai presisi sebanyak 100%.
- Model collaborative filtering dapat memberikan 10 hasil rekomendasi produk kepada pengguna berdasarkan data ulasan dan produk dan sesuai dengan preferensi pengguna lain dengan preferensi yang sama.
"""